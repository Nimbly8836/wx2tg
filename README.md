# 简介

本工具是一款将微信消息转发到 Telegram 的小工具，使用了大佬开放的 iPad 协议实现。
运行前请确保 [Gewechat](https://github.com/Devo919/Gewechat) 能正常使用。

## 关于

目前已支持基础消息，支持的消息类型包括：

- 文本
- 引用消息
- 红包消息
- 图片
- 视频
- 表情包
- 文件

暂时不支持的消息类型：

- 语音
- 小程序

## 部署

**注意事项：**

1. Gewechat 服务可能需要与你部署在同一省份运行（之前在同省运行一段时间后，有可能能在不同地区运行）。
2. 必须使用 Telegram 的 API_ID 和 API_HASH，请注意使用 User Bot 可能会增加被封号的风险。
3. 数据库使用 PG 数据库。
4. BOT 需要关闭 Privacy Mode（隐私模式，可在 BotFather 或 /mybots 中设置）。

**常见问题：**

*无法登录或未显示二维码：*

1. 使用命令 `/rmds` 删除微信保存的缓存文件。
2. 手机退出 iPad 版微信。
3. 重启 gewe 容器。
4. 如仍无法登录，请多试几次。

*设置回调地址失败：*

1. 设置 `GEWE_IP` 环境变量；例如：用 Docker 运行的 gewe 容器时，将其设置为宿主机局域网的 IP（如 192.168.x.x）。
2. 重启服务。

**docker-compose 运行：**

1. 复制 `.env.example` 到 `.env` 并修改你的配置。
2. 根据你的配置docker/podman：

   ```shell
   docker compose up -d
    
   podman-compose up -d
   ```

## 使用

**首次使用：**

1. 发送 `/start` 按提示扫码登录 Telegram。
2. 发送 `/login` 登录微信。

**相关命令介绍：**

- **/user**  
  搜索联系人，支持模糊查询（用户名、全拼小写、简称拼音大写）；可在 BOT 聊天中手动创建群聊以绑定该联系人，或在群聊中更换绑定/绑定当前群。
- **/room**  
  搜索群聊，功能与 `/user` 类似。
- **/sc**  
  搜索 wx2tg 发送和接收的所有消息；在超级群且群聊记录对新成员可见时，可直接跳转。
- **/sw**  
  切换群组转发状态；关闭后停止接收和转发消息。
- **/sync**  
  同步联系人或群组消息；当头像和名称发生变化时会自动更新。
- **/fu**  
  强制更新头像，与 `/sync` 类似。
- **/ala**  
  添加当前群可转发的实体，目前支持机器人和用户。支持直接输入 id 或 @，其中所有人的 id 定义为 1，当存在所有人时，可在 id 或 @
  前加 '-' 进行排除。
- **/al**  
  列出当前群可转发的列表，点击可删除对应项。
- **/roomml**  
  查看群聊所有成员的信息，并支持搜索。
- **/info**  
  查看当前绑定的用户信息。
- **/check**  
  检查微信连接状态。

## 开发调试

1. **安装依赖**

   ```shell
   npm install
   ```

   *注意：Node 版本需 20 以上*

2. **修改配置文件**

   ```shell
   cp .env.example .env
   ```

3. **初始化数据库**

   ```shell
   npm run init-db
   ```

4. **启动**

   ```shell
   npm run dev
   ```

## 暂时无法解决的问题

1. 消息丢失
2. 语音文件无法下载